[gd_scene load_steps=16 format=3 uid="uid://dtvl6ccqkkmhh"]

[ext_resource type="PackedScene" uid="uid://c3sa7wipkeb6u" path="res://scenes/levels/level_4.tscn" id="1_1dpt0"]
[ext_resource type="PackedScene" uid="uid://b5d1qj4ck34vx" path="res://scenes/logica interna/player.tscn" id="1_j2esc"]
[ext_resource type="Script" path="res://scripts/player_replay_recording.gd" id="2_kr3wk"]
[ext_resource type="PackedScene" uid="uid://blocss3wbhbps" path="res://scenes/logica interna/camera_frame.tscn" id="2_lfbie"]
[ext_resource type="Script" path="res://scripts/player_scripted_movement.gd" id="2_rb5kb"]
[ext_resource type="Script" path="res://scripts/walls.gd" id="3_5q0w8"]
[ext_resource type="Script" path="res://scripts/PlayerReplayResource.gd" id="3_6jqjj"]
[ext_resource type="PackedScene" uid="uid://2gifhoikbqvm" path="res://scenes/logica interna/gui.tscn" id="14_s0k0l"]
[ext_resource type="PackedScene" uid="uid://b42fulegw3yie" path="res://scenes/logica interna/bg.tscn" id="15_cnecu"]
[ext_resource type="PackedScene" uid="uid://bjd51jnefxpxl" path="res://scenes/logica interna/pause_menu.tscn" id="16_c4wfa"]
[ext_resource type="Script" path="res://scripts/automatic_resize_of_collision_shape_2d.gd" id="26_k135g"]
[ext_resource type="Script" path="res://scenes/logica interna/pause.gd" id="26_krq3q"]

[sub_resource type="GDScript" id="GDScript_hpa0i"]
script/source = "extends Node2D

@onready var pause_menu = $Graphics/Pause/PauseMenu
@export var obstacles: Node2D 
@export var levels :Array[PackedScene]
var current_level := 0

func _input(event: InputEvent) -> void:
	if event.is_action_pressed(\"pause\"):
		toggle_pause()
	if event.is_action_pressed(\"Fast Restart\"):
		get_tree().change_scene_to_file(\"res://scenes/logica interna/main.tscn\")

func toggle_pause():
	if pause_menu.visible:
		pause_menu.hide()
		get_tree().paused = false
	else:
		pause_menu.show()
		get_tree().paused = true

func _on_player_death() -> void:
	obstacles.hide()


func load_level(level_scene: PackedScene) -> void:
	if obstacles != null:
		remove_child(obstacles)
	
	obstacles = level_scene.instantiate()
	add_child(obstacles)
"

[sub_resource type="RectangleShape2D" id="RectangleShape2D_lpsvg"]
size = Vector2(1457, 20)

[sub_resource type="Resource" id="Resource_26i00"]
script = ExtResource("3_6jqjj")
timestamp = Array[float]([0.454, 1.55, 1.816, 2.032, 2.249, 2.472, 2.661, 2.824, 3.158, 3.341, 3.507, 3.673, 3.84, 4.056, 4.222, 4.386, 4.57, 4.754, 4.853, 4.903, 5.135, 6.966, 7.524, 10.859, 11.282, 11.666, 13.531, 14.129])

[node name="Main" type="Node2D" node_paths=PackedStringArray("obstacles")]
process_mode = 1
scale = Vector2(1.00177, 1)
script = SubResource("GDScript_hpa0i")
obstacles = NodePath("Level4")

[node name="Level4" parent="." instance=ExtResource("1_1dpt0")]
position = Vector2(7612.6, -2919.8)

[node name="AutomaticResizeOfCollisionShape2D" type="Node" parent="Level4"]
script = ExtResource("26_k135g")

[node name="Player" parent="." node_paths=PackedStringArray("camera_frame") instance=ExtResource("1_j2esc")]
position = Vector2(723, 454)
scale = Vector2(1.00321, 1.15788)
collision_layer = 32
lock_rotation = true
continuous_cd = 1
camera_frame = NodePath("../CameraFrame")
speed = 1000.0

[node name="PlayerReplayRecorder" type="Node" parent="Player" node_paths=PackedStringArray("player")]
script = ExtResource("2_kr3wk")
player = NodePath("..")

[node name="GhostPlayer" parent="." node_paths=PackedStringArray("camera_frame") instance=ExtResource("1_j2esc")]
modulate = Color(1, 1, 1, 0.588235)
z_index = -3
position = Vector2(723, 454)
scale = Vector2(1.00077, 0.937648)
collision_layer = 32
lock_rotation = true
continuous_cd = 1
camera_frame = NodePath("CameraFrame2")
speed_change = 100.0
receive_input = false

[node name="MakeTrail" parent="GhostPlayer" index="4"]
scale_factor = 0.275

[node name="CameraFrame2" type="RigidBody2D" parent="GhostPlayer"]
position = Vector2(0, 7.46548)
scale = Vector2(0.999231, 1.0665)
collision_layer = 4
collision_mask = 0
gravity_scale = 0.0
script = ExtResource("3_5q0w8")

[node name="CollisionShape2D" type="CollisionShape2D" parent="GhostPlayer/CameraFrame2"]
position = Vector2(-1, -331)
shape = SubResource("RectangleShape2D_lpsvg")

[node name="CollisionShape2D2" type="CollisionShape2D" parent="GhostPlayer/CameraFrame2"]
position = Vector2(-0.5, 333)
shape = SubResource("RectangleShape2D_lpsvg")

[node name="PlayerAutoMovement" type="Node" parent="GhostPlayer" node_paths=PackedStringArray("player")]
script = ExtResource("2_rb5kb")
replay = SubResource("Resource_26i00")
player = NodePath("..")

[node name="CameraFrame" parent="." node_paths=PackedStringArray("player") instance=ExtResource("2_lfbie")]
player = NodePath("../Player")

[node name="Graphics" type="Node" parent="."]

[node name="GUI" parent="Graphics" instance=ExtResource("14_s0k0l")]

[node name="Bg" parent="Graphics" instance=ExtResource("15_cnecu")]

[node name="Pause" type="CanvasLayer" parent="Graphics"]
process_mode = 2
script = ExtResource("26_krq3q")

[node name="PauseMenu" parent="Graphics/Pause" instance=ExtResource("16_c4wfa")]
visible = false

[connection signal="death" from="Player" to="." method="_on_player_death"]
[connection signal="death" from="Player" to="Graphics/GUI" method="_on_player_death"]
[connection signal="gained_coin" from="Player" to="Graphics/GUI" method="update_coins"]
[connection signal="speed_changed" from="Player" to="Graphics/GUI" method="_on_player_speed_changed"]
[connection signal="victory" from="Player" to="Graphics/GUI" method="_on_player_victory"]

[editable path="GhostPlayer"]
